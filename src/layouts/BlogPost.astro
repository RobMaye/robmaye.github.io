---
import BaseLayout from "./BaseLayout.astro";
import FormattedDate from "../components/FormattedDate.astro";

import ClaudeNote from "../components/ClaudeNote.astro";
import { readingTime } from "../lib/utils";

interface Props {
  title: string;
  description: string;
  pubDate: Date;
  updatedDate?: Date;
  tags?: string[];

  claudeNote?: string;
  body: string;
}

const { title, description, pubDate, updatedDate, tags = [], claudeNote, body } =
  Astro.props;
---

<BaseLayout title={`${title} â€” Rob Maye`} description={description}>
  <article>
    <header class="mb-10">
      <h1
        class="text-3xl font-semibold tracking-tight text-stone-900 dark:text-stone-100 mb-3"
      >
        {title}
      </h1>
      <div
        class="flex items-center gap-3 text-sm text-stone-500 dark:text-stone-400"
      >
        <FormattedDate date={pubDate} />
        {
          updatedDate && (
            <span>
              (updated <FormattedDate date={updatedDate} />)
            </span>
          )
        }
        <span>&middot;</span>
        <span>{readingTime(body)}</span>
      </div>
    </header>

    <div class="prose">
      <slot />
    </div>

    {claudeNote && <ClaudeNote note={claudeNote} />}

    {
      tags.length > 0 && (
        <footer class="mt-12 pt-6 border-t border-stone-200 dark:border-stone-800">
          <div class="flex flex-wrap gap-2">
            {tags.map((tag) => (
              <span class="text-xs font-mono text-stone-400 dark:text-stone-500">
                #{tag}
              </span>
            ))}
          </div>
        </footer>
      )
    }
  </article>
</BaseLayout>
